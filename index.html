<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://honorzmj98.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="HonorZmj98">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://HonorZmj98.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-CSFramework小型开发工具" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/11/CSFramework%E5%B0%8F%E5%9E%8B%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" class="article-date">
  <time datetime="2020-03-11T01:05:28.981Z" itemprop="datePublished">2020-03-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/11/CSFramework%E5%B0%8F%E5%9E%8B%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">CSFramework小型开发工具</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp;&emsp;我们在计算机网络课程中学过网络的OSI的七层模型，但只是理解其描述的一些概念，并没有真正的实现，只是个概念性框架。而另一种提出的TCP/IP参考模型被投入应用了。参考前两种层次模型，我们可以提出CSFramework使用的层次模型，如下图。</p>
<img src="/img/CSFramework/2.png" alt="2" style="zoom: 67%;" />


      
    </div>
    <footer class="article-footer">
      <a data-url="https://honorzmj98.github.io/2020/03/11/CSFramework%E5%B0%8F%E5%9E%8B%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/" data-id="ck7o6d2ka00009ki20g3x7zkt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-CSFramework的引出" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/11/CSFramework%E7%9A%84%E5%BC%95%E5%87%BA/" class="article-date">
  <time datetime="2020-03-11T00:36:59.000Z" itemprop="datePublished">2020-03-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/11/CSFramework%E7%9A%84%E5%BC%95%E5%87%BA/">CSFramework的引出</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="CSFramework的引出：几个简单的网络通信例子"><a href="#CSFramework的引出：几个简单的网络通信例子" class="headerlink" title="CSFramework的引出：几个简单的网络通信例子"></a>CSFramework的引出：几个简单的网络通信例子</h2><p>&emsp;&emsp;现如今，互联网几乎在我身边随处可见，早已深入我们人类生活中。如今的软件如果没有网络功能，那是很不可思议的事情。(单机游戏都有局域网功能，小时候和朋友联机打的红警就是例子)。许多语言都支持网络编程，我见过C与Java有关网络的程序代码，从中深刻感受到有工具和没工具编代码效率是多么天差地别。就相当于在赛跑，C还在那里造车轮子，Java已经开始用别人给的车开始跑了。<br>&emsp;&emsp;最近一直在学习Java，因此用Java学习网络编程。C/S模式，又称客户端服务器模式。至少用两台计算机来分别充当客户机和服务器角色。C/S模式将应用（对于客户端来说）与服务（对于服务器来说）分离，两边各自开发自己的，两套程序。对于服务器，Java提供一个ServerSocket类来创建服务器，对于客户端，Java提供一个Socket类可以连接服务器。<br>&emsp;&emsp;接下来，就先写三个简单的网络通信的例子（一对一单次通信和一对一多次通信）来熟悉下相关类。</p>
<h3 id="一对一单次通信"><a href="#一对一单次通信" class="headerlink" title="一对一单次通信"></a>一对一单次通信</h3><p>&emsp;&emsp;一对一单次通信：一个服务器和一个客户端单次通信</p>
<p>服务器方代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OneToOneServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> port = <span class="number">54188</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"开始启动服务器..."</span>);</span><br><span class="line">			ServerSocket server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">			System.out.println(<span class="string">"服务器启动成功!"</span>);</span><br><span class="line">			System.out.println(<span class="string">"开始侦听客户端连接请求..."</span>);</span><br><span class="line">			Socket client = server.accept();</span><br><span class="line">			InetAddress inetaddress = client.getInetAddress();</span><br><span class="line">			String clientIp = inetaddress.getHostAddress();	<span class="comment">//客户端ip地址</span></span><br><span class="line">			String clientName = inetaddress.getHostName(); <span class="comment">//客户端名称</span></span><br><span class="line">			System.out.println(<span class="string">"发现客户端(ip: "</span> + clientIp	+ <span class="string">", 主机名:"</span> + clientName + <span class="string">")请求连接服务器"</span>);</span><br><span class="line">			DataInputStream dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());  <span class="comment">//开始建立通信信道</span></span><br><span class="line">			DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">            System.out.println(<span class="string">"通信信道已建立完成"</span>);</span><br><span class="line">			</span><br><span class="line">			String message = dis.readUTF();</span><br><span class="line">			System.out.println(<span class="string">"来自客户端的消息["</span> + message + <span class="string">"]"</span>);</span><br><span class="line">			dos.writeUTF(<span class="string">"我收到你的消息了"</span>);</span><br><span class="line">			</span><br><span class="line">			dis.close();</span><br><span class="line">			dos.close();</span><br><span class="line">			client.close();</span><br><span class="line">			server.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OneToOneClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		String serverIp = <span class="string">"127.0.0.1"</span>;	</span><br><span class="line">        <span class="comment">//服务器ip地址，因为本地测试所以127.0.0.1</span></span><br><span class="line">		<span class="keyword">int</span> serverPort = <span class="number">54188</span>;</span><br><span class="line">        <span class="comment">//和服务器协商好的</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			System.out.println(<span class="string">"开始连接服务器....."</span>);</span><br><span class="line">			Socket socket = <span class="keyword">new</span> Socket(serverIp, serverPort);</span><br><span class="line">			System.out.println(<span class="string">"连接成功"</span>);</span><br><span class="line">			DataInputStream dis = <span class="keyword">new</span> DataInputStream(socket.getInputStream());</span><br><span class="line">			DataOutputStream dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">			</span><br><span class="line">			dos.writeUTF(<span class="string">"你好，我是一个客户端"</span>);</span><br><span class="line">			String message = dis.readUTF();</span><br><span class="line">			System.out.println(<span class="string">"来自服务器的消息:"</span> + message);</span><br><span class="line">			</span><br><span class="line">			dis.close();</span><br><span class="line">			dos.close();</span><br><span class="line">			socket.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;			<span class="comment">//服务器名称或地址不存在。未知主机异常</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#服务器</span></span><br><span class="line"><span class="attr">开始启动服务器...</span></span><br><span class="line"><span class="attr">服务器启动成功!</span></span><br><span class="line"><span class="attr">开始侦听客户端连接请求...</span></span><br><span class="line"><span class="meta">发现客户端(ip</span>: <span class="string">127.0.0.1, 主机名:127.0.0.1)请求连接服务器</span></span><br><span class="line"><span class="attr">通信信道已建立完成</span></span><br><span class="line"><span class="attr">来自客户端的消息[你好，我是一个客户端]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端</span></span><br><span class="line"><span class="attr">开始连接服务器.....</span></span><br><span class="line"><span class="attr">连接成功</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">我收到你的消息了</span></span><br></pre></td></tr></table></figure>

<p>从上面一对一通信程序，希望你能了解到以下几点。</p>
<p>服务器方面:</p>
<ul>
<li>ServerSocket的建立需要port（端口号），且这个端口号必须和连接的客户端保持一直，也就是说要和客户端协商好。</li>
<li>如果没有客户端连接，程序会卡在accept()那个地方，可以类似于scanf函数，若没有客户端连接则程序会停在accept()那个地方，有客户端连接才会让程序向下进行</li>
<li>可以让客户端先不发消息（把发消息那里注释掉），观察情况，发现两个程序都卡住了，都卡在dis.readUTF()这里。所以dis.readUTF()这个方法也是类似于scanf函数，没有收到对端的消息就卡在这，程序不往下走。dis.readUTF()这个方法是读对端发来的消息，是被动的等，一直等，没有就停在这里</li>
<li>dos.writeUTF()相当于给对端发消息，主动的发消息。</li>
</ul>
<p>客户端方面:</p>
<ul>
<li>Socket的建立需要服务器的ip地址和和服务器协商好的port</li>
<li>也需要建立DataInputStream和DataOutputStream</li>
</ul>
<p>总结一下服务器和客户端都需要DataInputStream和DataOutputStream。它俩相当于什么呢？可以这么说就相当于我们学的通信原理里面的信道那个概念，两端进行信息交换的通信信道；也可以举个现实生活中的例子，就是我们的座机电话，他有两端，上面是听筒端（DataInputStream）和说话端（DataOutputStream）。</p>
<hr>
<h3 id="一对一多次通信"><a href="#一对一多次通信" class="headerlink" title="一对一多次通信"></a>一对一多次通信</h3><p>&emsp;&emsp;一对一多次通信:一个服务器和一个客户端多次通信</p>
<p>&emsp;&emsp;上述一对一单次通信的代码很简单，我们要从中熟悉一些需要用的类。但是，我相信肯定不是上面我们最终的目的吧？不可能通信只通信一句话吧？所以来进一步实现一个客户端和一个服务器多次通信。</p>
<p>&emsp;&emsp;如何进行多次通信呢？经过思考只要通信信道不关闭，就可以多次发送消息。但不能一直通信下去，要有办法停止，也就是可控性。所以定发特定的字符串就停止下来。</p>
<p>服务器代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleServer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> ServerSocket serverSocket;</span><br><span class="line">	<span class="keyword">private</span> DataInputStream dis;</span><br><span class="line">	<span class="keyword">private</span> DataOutputStream dos;</span><br><span class="line">	<span class="keyword">private</span> Socket client;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SimpleServer</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		port = <span class="number">54188</span>;</span><br><span class="line">		System.out.println(<span class="string">"开始建立服务器"</span>);</span><br><span class="line">		serverSocket = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">		System.out.println(<span class="string">"服务器建立完成"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (dis != <span class="keyword">null</span>) &#123;</span><br><span class="line">				dis.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			dis = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (dos != <span class="keyword">null</span>) &#123;</span><br><span class="line">				dos.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			dos = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (client != <span class="keyword">null</span> &amp;&amp; !client.isClosed()) &#123;</span><br><span class="line">				client.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			client = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (serverSocket != <span class="keyword">null</span> &amp;&amp; !serverSocket.isClosed()) &#123;</span><br><span class="line">				serverSocket.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			serverSocket = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">listeningClient</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"开始侦听客户端连接请求"</span>);</span><br><span class="line">		client = serverSocket.accept();</span><br><span class="line">		System.out.println(<span class="string">"客户端["</span> + client.getInetAddress().getHostAddress() + <span class="string">", "</span> + client.getInetAddress().getHostName()</span><br><span class="line">				+ <span class="string">"]连入服务器"</span>);</span><br><span class="line">		</span><br><span class="line">		dis = <span class="keyword">new</span> DataInputStream(client.getInputStream());</span><br><span class="line">		dos = <span class="keyword">new</span> DataOutputStream(client.getOutputStream());</span><br><span class="line">		</span><br><span class="line">		String message = <span class="string">""</span>;</span><br><span class="line">        System.out.println(<span class="string">"接受来自客户端的消息..."</span>);</span><br><span class="line">		<span class="keyword">while</span> (!message.equalsIgnoreCase(<span class="string">"byebye"</span>)) &#123;</span><br><span class="line">			message = dis.readUTF();</span><br><span class="line">			System.out.println(<span class="string">"来自客户端的消息:"</span> + message);</span><br><span class="line">			dos.writeUTF(<span class="string">"["</span> + message + <span class="string">"]"</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> String ip;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> DataInputStream dis;</span><br><span class="line">	<span class="keyword">private</span> DataOutputStream dos;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SimpleClient</span><span class="params">()</span> <span class="keyword">throws</span> UnknownHostException, IOException </span>&#123;</span><br><span class="line">		ip = <span class="string">"127.0.0.1"</span>;</span><br><span class="line">		port = <span class="number">54188</span>;</span><br><span class="line">		System.out.println(<span class="string">"开始连接服务器..."</span>);</span><br><span class="line">		socket = <span class="keyword">new</span> Socket(ip, port);</span><br><span class="line">		System.out.println(<span class="string">"连接服务器成功"</span>);</span><br><span class="line">		dis = <span class="keyword">new</span> DataInputStream(socket.getInputStream());</span><br><span class="line">		dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">talking</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String message = <span class="string">""</span>;</span><br><span class="line">		String messageFromServer;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">while</span>(!message.equalsIgnoreCase(<span class="string">"byebye"</span>)) &#123;</span><br><span class="line">				message = in.nextLine();</span><br><span class="line">				dos.writeUTF(message);</span><br><span class="line">				messageFromServer = dis.readUTF();</span><br><span class="line">				System.out.println(<span class="string">"来自服务器的消息:"</span> +messageFromServer);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		in.close();</span><br><span class="line">		close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (dis != <span class="keyword">null</span>) &#123;</span><br><span class="line">				dis.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			dis = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (dos != <span class="keyword">null</span>) &#123;</span><br><span class="line">				dos.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			dos = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (socket != <span class="keyword">null</span> &amp;&amp; !socket.isClosed()) &#123;</span><br><span class="line">				socket.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			socket = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行代码。<strong>注意:</strong>要先运行服务器，在运行客户端</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">new</span> SimpleServer().listeningClient();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">new</span> SimpleClient().talking();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>显示结果如下</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#服务器</span></span><br><span class="line"><span class="attr">开始建立服务器</span></span><br><span class="line"><span class="attr">服务器建立完成</span></span><br><span class="line"><span class="attr">开始侦听客户端连接请求</span></span><br><span class="line"><span class="meta">客户端[127.0.0.1,</span> <span class="string">127.0.0.1]连入服务器</span></span><br><span class="line"><span class="attr">接受来自客户端的消息...</span></span><br><span class="line"><span class="meta">来自客户端的消息</span>:<span class="string">你好</span></span><br><span class="line"><span class="meta">来自客户端的消息</span>:<span class="string">我是一个客户端</span></span><br><span class="line"><span class="meta">来自客户端的消息</span>:<span class="string">byebye</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端</span></span><br><span class="line"><span class="attr">开始连接服务器...</span></span><br><span class="line"><span class="attr">连接服务器成功</span></span><br><span class="line"><span class="attr">你好</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">[你好]</span></span><br><span class="line"><span class="attr">我是一个客户端</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">[我是一个客户端]</span></span><br><span class="line"><span class="attr">byebye</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">[byebye]</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="一对多多次通信"><a href="#一对多多次通信" class="headerlink" title="一对多多次通信"></a>一对多多次通信</h3><p>&emsp;&emsp;一对多多次通信:一个服务器和多个客户端的多次通信</p>
<p>&emsp;&emsp;前面的代码不是我们最终的目的，如果一个服务器只能接入一个客户端，你说他还能称为服务器吗？服务器作为网络节点中心管理者，要实现接入多个客户端的功能。经过分析上述代码得知之所以只接入了一个客户端的原因是，accept()方法只运行了一次，要想接入多个客户端，必须让accept()方法重复执行，我们可以把它放在循环里，条件是服务器关闭与否。但是还是有问题，前面说过accept()方法相当于scanf函数，没有接入它的客户端，程序会卡在那里阻止下面通信的代码。解决方法:用<font color= red><strong>线程</strong></font>。服务器accept()侦听客户端连接用线程并行去跑，不要影响我下面的代码。</p>
<p>&emsp;&emsp;同时分析上述代码我们可以知道每连接一个新的客户端都要新造一个独立的通信信道，这是当然啦，你要和服务器建立联系，就得造通信信道，该通信信道是只有你和服务器用的，独立的，不能让别人用。两端都要有通信信道(DataInputStream和DataOutputStream)所以我们最好把它单独拎出来做成一个类。同时我们知道dis.read()方法也相当于scanf函数，程序卡在这里不会运行以后的代码，你等待对端消息不能干扰我主动给对端发消息吧。因此，也用<font color= red><strong>线程</strong></font>解决。</p>
<p>&emsp;&emsp;只有做到以上两点，才能完成一对多多次通信。才能实现服务器边听（侦听客户端连接）边说（给对端发消息）！可以用以下图示来说明。</p>
<img src="/img/CSFramework/1.png" style="zoom: 50%;" />



<p>先写双方都需要建立的通信信道类Communcation</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Communcation</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> DataInputStream dis;</span><br><span class="line">	<span class="keyword">private</span> DataOutputStream dos;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">volatile</span> <span class="keyword">boolean</span> goon;	<span class="comment">//volatitle关键字:拒绝内存优化，这是线程安全相关问题</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Communcation</span><span class="params">(Socket socket)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.socket = socket;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			dis = <span class="keyword">new</span> DataInputStream(socket.getInputStream());</span><br><span class="line">			dos = <span class="keyword">new</span> DataOutputStream(socket.getOutputStream());</span><br><span class="line">			goon = <span class="keyword">true</span>;</span><br><span class="line">			<span class="keyword">new</span> Thread(<span class="keyword">this</span>, <span class="string">"通信层"</span>).start();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">send</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			dos.writeUTF(message);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">dealPeerMessage</span><span class="params">(String message)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">dealPeerAbnoramlDrop</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		String message = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">while</span> (goon) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				message = dis.readUTF();</span><br><span class="line">				dealPeerMessage(message);	<span class="comment">//处理对端消息具体做法让外面来决定</span></span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				<span class="keyword">if</span> (goon == <span class="keyword">true</span>) &#123;</span><br><span class="line">					dealPeerAbnoramlDrop();	<span class="comment">//当goon还是true的时候，说明是对端异常掉线，做法让外面来决定</span></span><br><span class="line">				&#125;</span><br><span class="line">				close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		goon = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (socket != <span class="keyword">null</span> &amp;&amp; !socket.isClosed()) &#123;</span><br><span class="line">				socket.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			socket = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (dis != <span class="keyword">null</span>) &#123;</span><br><span class="line">				dis.close();</span><br><span class="line">			&#125;	</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			dis = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (dos != <span class="keyword">null</span>) &#123;</span><br><span class="line">				dos.close();</span><br><span class="line">			&#125;	</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			dos = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器相关代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MulServer</span> <span class="keyword">implements</span> <span class="title">Runnable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> ServerSocket server;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">boolean</span> goon;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MulServer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		port = <span class="number">54188</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startUp</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (goon == <span class="keyword">true</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"服务器已经启动，请勿重复启动"</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		System.out.println(<span class="string">"开始建立服务器..."</span>);</span><br><span class="line">		server = <span class="keyword">new</span> ServerSocket(port);</span><br><span class="line">		System.out.println(<span class="string">"服务器建立成功"</span>);</span><br><span class="line">		goon = <span class="keyword">true</span>;</span><br><span class="line">		System.out.println(<span class="string">"开始侦听客户端连接..."</span>);</span><br><span class="line">		<span class="keyword">new</span> Thread(<span class="keyword">this</span>, <span class="string">"服务器"</span>).start();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">shutDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (goon == <span class="keyword">false</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"服务器已经宕机，请勿重复宕机"</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		close();</span><br><span class="line">		System.out.println(<span class="string">"服务器正常宕机"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isStartup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> goon;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (goon) &#123;</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				Socket client = server.accept();</span><br><span class="line">				System.out.println(<span class="string">"客户端["</span> + client.getInetAddress().getHostAddress() + </span><br><span class="line">						client.getInetAddress().getHostName() + <span class="string">"]连入服务器"</span>);</span><br><span class="line">				<span class="keyword">new</span> Communcation(client) &#123;</span><br><span class="line">					</span><br><span class="line">					<span class="meta">@Override</span></span><br><span class="line">					<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">dealPeerMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">						<span class="keyword">if</span> (message.equalsIgnoreCase(<span class="string">"byebye"</span>)) &#123;</span><br><span class="line">							System.out.println(<span class="string">"客户端正常下线"</span>);</span><br><span class="line">							close();</span><br><span class="line">							<span class="keyword">return</span>;</span><br><span class="line">						&#125;</span><br><span class="line">						System.out.println(<span class="string">"收到来自客户端的消息:"</span> + message);</span><br><span class="line">						send(<span class="string">"["</span> + message +<span class="string">"]"</span>);</span><br><span class="line">					&#125;</span><br><span class="line">					</span><br><span class="line">					<span class="meta">@Override</span></span><br><span class="line">					<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">dealPeerAbnoramlDrop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">						System.out.println(<span class="string">"客户端异常掉线"</span>);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;;</span><br><span class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">				close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		goon = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (server != <span class="keyword">null</span> &amp;&amp; !server.isClosed()) &#123;</span><br><span class="line">				server.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">			server = <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端相关代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MulClient</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Socket socket;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> port;</span><br><span class="line">	<span class="keyword">private</span> String serverIp;</span><br><span class="line">	<span class="keyword">private</span> Communcation communcation;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MulClient</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		port = <span class="number">54188</span>;</span><br><span class="line">		serverIp = <span class="string">"127.0.0.1"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (communcation == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		communcation.send(message);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (communcation == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		communcation.close();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">connectToServer</span><span class="params">()</span> <span class="keyword">throws</span> UnknownHostException, IOException </span>&#123;</span><br><span class="line">		socket = <span class="keyword">new</span> Socket(serverIp, port);</span><br><span class="line">		communcation = <span class="keyword">new</span> Communcation(socket) &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">dealPeerMessage</span><span class="params">(String message)</span> </span>&#123;</span><br><span class="line">				System.out.println(<span class="string">"来自服务器的消息:"</span> + message);</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">dealPeerAbnoramlDrop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">				System.out.println(<span class="string">"服务器异常宕机，服务停止"</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务器测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServerTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		MulServer mulServer = <span class="keyword">new</span> MulServer();</span><br><span class="line">		Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">		String command = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">boolean</span> finshed = <span class="keyword">false</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">while</span> (!finshed) &#123;</span><br><span class="line">			command = in.next();</span><br><span class="line">			<span class="keyword">if</span> (command.equalsIgnoreCase(<span class="string">"st"</span>)) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					mulServer.startUp();</span><br><span class="line">				&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.equalsIgnoreCase(<span class="string">"sd"</span>)) &#123;</span><br><span class="line">				mulServer.shutDown();</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.equalsIgnoreCase(<span class="string">"x"</span>)) &#123;</span><br><span class="line">				<span class="keyword">if</span> (!mulServer.isStartup()) &#123;</span><br><span class="line">					finshed = <span class="keyword">true</span>;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					System.out.println(<span class="string">"服务器尚未宕机!"</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		in.close();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>客户端测试代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClientTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		MulClient client = <span class="keyword">new</span> MulClient();</span><br><span class="line">		<span class="keyword">boolean</span> finished = <span class="keyword">false</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			client.connectToServer();</span><br><span class="line">			</span><br><span class="line">			Scanner in = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">			</span><br><span class="line">			String message = <span class="string">""</span>;</span><br><span class="line">			<span class="keyword">while</span> (!finished) &#123;</span><br><span class="line">				message = in.next();</span><br><span class="line">				client.send(message);</span><br><span class="line">				<span class="keyword">if</span> (message.equalsIgnoreCase(<span class="string">"byebye"</span>)) &#123;</span><br><span class="line">					client.close();</span><br><span class="line">					finished = <span class="keyword">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			in.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnknownHostException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先运行服务器测试代码，在运行客户端测试代码。进行测试结果如下</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#服务器</span></span><br><span class="line"><span class="attr">st</span></span><br><span class="line"><span class="attr">开始建立服务器...</span></span><br><span class="line"><span class="attr">服务器建立成功</span></span><br><span class="line"><span class="attr">开始侦听客户端连接...</span></span><br><span class="line"><span class="attr">客户端[127.0.0.1127.0.0.1]连入服务器</span></span><br><span class="line"><span class="attr">客户端[127.0.0.1127.0.0.1]连入服务器</span></span><br><span class="line"><span class="attr">客户端[127.0.0.1127.0.0.1]连入服务器</span></span><br><span class="line"><span class="meta">收到来自客户端的消息</span>:<span class="string">123</span></span><br><span class="line"><span class="meta">收到来自客户端的消息</span>:<span class="string">456</span></span><br><span class="line"><span class="meta">收到来自客户端的消息</span>:<span class="string">789</span></span><br><span class="line"><span class="attr">客户端正常下线</span></span><br><span class="line"><span class="attr">客户端异常掉线</span></span><br><span class="line"><span class="attr">客户端正常下线</span></span><br><span class="line"><span class="attr">sd</span></span><br><span class="line"><span class="attr">服务器正常宕机</span></span><br><span class="line"><span class="attr">x</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端1</span></span><br><span class="line"><span class="attr">123</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">[123]</span></span><br><span class="line"><span class="attr">byebye</span></span><br><span class="line"><span class="comment">#客户端2 故意强制关闭</span></span><br><span class="line"><span class="attr">456</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">[456]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#客户端3</span></span><br><span class="line"><span class="attr">789</span></span><br><span class="line"><span class="meta">来自服务器的消息</span>:<span class="string">[789]</span></span><br><span class="line"><span class="attr">byebye</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>&emsp;&emsp;一对多多次通信就完成了。服务器可以接入多个客户端，客户端可以发消息给服务器。但是，这就完了吗？这就是我们想要的吗？我并不认为就完了，我们做的功能太简陋了，完全不够用。同时思考可不可以将底层通信的代码做成工具，做成普适性工具，这样以后开发不同需求的C/S程序就会方便很多。这就是框架的含义，也就是我们要做的工具CSFramework。 </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://honorzmj98.github.io/2020/03/11/CSFramework%E7%9A%84%E5%BC%95%E5%87%BA/" data-id="ck7mlmzpe0000ogi2blftbfgv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-XML文件与Properites文件解析工具" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/06/XML%E6%96%87%E4%BB%B6%E4%B8%8EProperites%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/" class="article-date">
  <time datetime="2020-03-06T08:19:34.669Z" itemprop="datePublished">2020-03-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/06/XML%E6%96%87%E4%BB%B6%E4%B8%8EProperites%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/">XML文件与Properites文件解析工具</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp; &emsp;XML文件与Properties文件在我的Java学习中和以后要接触的框架中十分常见的文件类型。这些文件懂了相关的编写规则后会十分容易写出来，但是作为配置文件如何去用它才是关键。人根据自己要完成的目的编写相关文件，可是你把这个文件放在计算机面前它不懂啊，它只知道01序列。因此，对于这种高频出现的文件，我们有必要编程，编写一个工具来解析它，方便以后使用。我不是直接把相关解析工具代码直接贴出来，而是一步步写关于这个工具如何造出来，这样才能学习更深刻并且里面蕴含的工具思想也能写出来。</p>
<h2 id="XML文件解析工具"><a href="#XML文件解析工具" class="headerlink" title="XML文件解析工具"></a>XML文件解析工具</h2><p>​        XML(Extensible Markup Language)，中文翻译为可扩展标记语言。它可以用来标记数据、定义数据类型，是一种允许用户对自己的标记语言进行定义的源语言。（<em>以上摘自百度百科</em>）使用它我们可以很容易的描述复杂的层次数据结构。例如，下面给的一个XML文件简单例子，学生基本信息。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">students</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">student</span> <span class="attr">name</span>= <span class="string">"张三"</span> <span class="attr">id</span>= <span class="string">"20203035"</span> <span class="attr">sex</span>= <span class="string">"男"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">hobbies</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>打游戏<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>篮球<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>学习<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">hobbies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">student</span> <span class="attr">name</span>= <span class="string">"李四"</span> <span class="attr">id</span>= <span class="string">"20203036"</span> <span class="attr">sex</span>= <span class="string">"男"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">hobbies</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>足球<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>写作<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>摄影<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">hobbies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">student</span> <span class="attr">name</span>= <span class="string">"王五"</span> <span class="attr">id</span>= <span class="string">"20203037"</span> <span class="attr">sex</span>= <span class="string">"女"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">hobbies</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>购物<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>逛街<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">hobby</span>&gt;</span>羽毛球<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">hobbies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">students</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>​        只是个简单的学生信息XML文件。对XML文件稍有了解，知道&lt;&gt;&lt;/&gt;是标签，标签里面带着的叫做属性。分析上面XML文件知，根标签是students(根标签必须有)，下一个标签student，其中有三个属性(name, id, sex)，下一个标签是hobbies，然后下一个标签是hobby。看到这个XML文件有没有觉得它特别像树形结构。因此，我们使用四种XML解析方式之一的DOM解析。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			DocumentBuilder documentBuilder = documentBuilderFactory.newDocumentBuilder();</span><br><span class="line">			InputStream is = Test.class.getResourceAsStream("/studentInfo.xml");</span><br><span class="line">			<span class="comment">//这里是用当前类的class.getResourceAsStream。参数是相对路径。</span></span><br><span class="line">			Document document = documentBuilder.parse(is);</span><br><span class="line">			<span class="comment">//前面四句话是不是看的一头雾水？我最初学也是，这里没必要刨根问底，当作巫师的咒语吧！</span></span><br><span class="line">			</span><br><span class="line">			NodeList studentList = document.getElementsByTagName(<span class="string">"student"</span>);</span><br><span class="line">            <span class="comment">//根据标签名得到一个结点列表</span></span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; studentList.getLength(); i++) &#123;</span><br><span class="line">				StudentInfo stu = <span class="keyword">new</span> StudentInfo();	</span><br><span class="line">                <span class="comment">//StudentInfo类只是为了最后显示好看。</span></span><br><span class="line">				Element student = (Element) studentList.item(i);</span><br><span class="line">                <span class="comment">//要把Node类型强转为Element类型</span></span><br><span class="line">				String name = student.getAttribute(<span class="string">"name"</span>);</span><br><span class="line">				String id = student.getAttribute(<span class="string">"id"</span>);</span><br><span class="line">				String sex = student.getAttribute(<span class="string">"sex"</span>);</span><br><span class="line">				stu.setId(id);</span><br><span class="line">				stu.setSex(sex);</span><br><span class="line">				stu.setName(name);</span><br><span class="line">				</span><br><span class="line">				NodeList hobbyList = student.getElementsByTagName(<span class="string">"hobby"</span>);</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; hobbyList.getLength(); j++) &#123;</span><br><span class="line">					String hobbyString = hobbyList.item(j).getTextContent();</span><br><span class="line">					stu.addHobby(hobbyString);</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(stu);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ParserConfigurationException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SAXException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        关于NodeList，Node，Element这几个类我需要说一下。</p>
<p>​        getElementsByTagName(“标签名”)获得的是个NodeList，没办法强转成Element。但可以遍历这个NodeList，item(index)方法取得相应的一个Node。Node与Element之间有关系。</p>
<p>​        对于一个出现多次的标签(student)，我们获得一个NodeList，遍历它，如果又遇到出现多次的标签(hobby)，再获得一个NodeList，遍历它，如此下去，直到所有标签都被过一遍。</p>
<p>​        总结:NodeList是标签多次出现组成，最终要访问到具体内容还是要提供Element，NodeList与Element之间转换通过Node完成。</p>
<img src="/img/XML/1.png" alt="1" style="zoom: 80%;" />

<p>要用的Model类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentInfo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String id;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> String sex;</span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; hobbies;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">StudentInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		hobbies = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sex;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sex = sex;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getHobbies</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> hobbies;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addHobby</span><span class="params">(String hobby)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (hobby == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (hobbies.contains(hobby)) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		hobbies.add(hobby);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		StringBuffer stu = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">		stu.append(name).append(<span class="string">" "</span>)</span><br><span class="line">			.append(id).append(<span class="string">" "</span>)</span><br><span class="line">			.append(sex).append(<span class="string">" "</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> (String hobby : hobbies) &#123;</span><br><span class="line">			stu.append(<span class="string">"\n"</span>).append(<span class="string">"\t"</span>).append(hobby);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> stu.toString();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>运行结果</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">张三 <span class="number">20203035</span> 男 </span><br><span class="line">	打游戏</span><br><span class="line">	篮球</span><br><span class="line">	学习</span><br><span class="line">李四 <span class="number">20203036</span> 男 </span><br><span class="line">	足球</span><br><span class="line">	写作</span><br><span class="line">	摄影</span><br><span class="line">王五 <span class="number">20203037</span> 女 </span><br><span class="line">	购物</span><br><span class="line">	逛街</span><br><span class="line">	羽毛球</span><br></pre></td></tr></table></figure>

<p>​        接下来就是制作工具了。所谓工具就是<strong>工具制造者把那些重复的、一成不变的代码提取出来做成工具，而那些会变部分的代码向外提供，由工具使用者去实现</strong>。就比如现在给你的不是这个学生信息XML表了，而换了另一个XML让你解析，再看解析代码，发现for循环上面的都是一成不变的（除了参数），而底下的真正解析过程会随着不同XML变化。</p>
<p>​        以后处理XML文件，在结构上任何XML文件都是相同的。只是在细节上标签名或者属性名有所差别而已。相同之处做成工具，造工具的人只编写XML相同的，结构相似的部分；差别之处拎出来提供给外面，让工具使用者去完成。</p>
<h3 id="XMLParse工具类"><a href="#XMLParse工具类" class="headerlink" title="XMLParse工具类"></a>XMLParse工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilder;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.DocumentBuilderFactory;</span><br><span class="line"><span class="keyword">import</span> javax.xml.parsers.ParserConfigurationException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Document;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.Element;</span><br><span class="line"><span class="keyword">import</span> org.w3c.dom.NodeList;</span><br><span class="line"><span class="keyword">import</span> org.xml.sax.SAXException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">XMLParse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> DocumentBuilderFactory dbf;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> DocumentBuilder db;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		dbf = DocumentBuilderFactory.newInstance();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			db = dbf.newDocumentBuilder();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ParserConfigurationException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">XMLParse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Document <span class="title">getDocument</span><span class="params">(InputStream is)</span> </span>&#123;</span><br><span class="line">		Document document = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			document = db.parse(is);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SAXException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> document;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Document <span class="title">getDocument</span><span class="params">(String xmlPath)</span> </span>&#123;</span><br><span class="line">		InputStream is = XMLParse<span class="class">.<span class="keyword">class</span>.<span class="title">getResourceAsStream</span>(<span class="title">xmlPath</span>)</span>;</span><br><span class="line">		<span class="keyword">if</span> (is == <span class="keyword">null</span>) &#123;</span><br><span class="line">			System.out.println(<span class="string">"xmlPath["</span> +xmlPath + <span class="string">"不存在"</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> getDocument(is);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/*getElementsByTagName写了两次，但两次前缀不一样，一个是doucument,一个是element类型的,覆盖就行了*/</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parseTag</span><span class="params">(Document document, String tagName)</span> </span>&#123;</span><br><span class="line">		NodeList nodeList = document.getElementsByTagName(tagName);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; nodeList.getLength(); index++) &#123;	</span><br><span class="line">			Element element = (Element) nodeList.item(index);	</span><br><span class="line">            <span class="comment">//底下的内容不同的xml解析不尽相同,工具写到这没法写了。</span></span><br><span class="line">			dealElement(element, index);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">parseTag</span><span class="params">(Element element, String tagName)</span> </span>&#123;</span><br><span class="line">		NodeList nodeList = element.getElementsByTagName(tagName);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; nodeList.getLength(); index++) &#123;	</span><br><span class="line">			Element ele = (Element) nodeList.item(index);	</span><br><span class="line">            <span class="comment">//底下的内容不同的xml解析不尽相同,工具写到这没法写了。</span></span><br><span class="line">			<span class="comment">//后面对ele进一步解析：取属性，取textContent或进一步取Element都应该是未来的工具使用者操心的事，我要做的仅仅是是把ele交给对方</span></span><br><span class="line">			dealElement(ele, index);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">dealElement</span><span class="params">(Element element, <span class="keyword">int</span> index)</span></span>;	</span><br><span class="line">    <span class="comment">//这个index让用户知道处理到第几项都能知道</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>XML文件解析工具就写出来了。还是那句话将那些已经确定了的代码写好，对于以后操作者如何去用我不管，我也管不着，所以将它传给外面，尽量将有用的信息都传出去，因为这样使用工具的人才能多一些机会做自己的操作。</p>
<p>如何去用这个工具下面给个例子。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LocalTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">new</span> XMLParse() &#123;		<span class="comment">//直接用匿名内部类去使用，方便快捷。</span></span><br><span class="line">			</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealElement</span><span class="params">(Element element, <span class="keyword">int</span> index)</span> </span>&#123;<span class="comment">//循环都不用写了，因为这句话就在循环里</span></span><br><span class="line">				StudentInfo stu = <span class="keyword">new</span> StudentInfo();</span><br><span class="line">				String name = element.getAttribute(<span class="string">"name"</span>);	<span class="comment">//此时这个element就是标签student</span></span><br><span class="line">				String id = element.getAttribute(<span class="string">"id"</span>);</span><br><span class="line">				String sex = element.getAttribute(<span class="string">"sex"</span>);</span><br><span class="line">				stu.setId(id);</span><br><span class="line">				stu.setSex(sex);</span><br><span class="line">				stu.setName(name);</span><br><span class="line">				<span class="keyword">new</span> XMLParse() &#123;</span><br><span class="line">					</span><br><span class="line">					<span class="meta">@Override</span></span><br><span class="line">					<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealElement</span><span class="params">(Element element, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">                        <span class="comment">//始终记得的这个是在循环里</span></span><br><span class="line">						<span class="comment">//可直接再使用匿名内部类解析下一个标签。也可以新建方法解析把这层提出去，这样可读性更强，且不会造成代码逻辑混乱。</span></span><br><span class="line">						String hobbyString = element.getTextContent();</span><br><span class="line">						stu.addHobby(hobbyString);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;.parseTag(element, <span class="string">"hobby"</span>);</span><br><span class="line">				System.out.println(stu);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;.parseTag(XMLParse.getDocument(<span class="string">"/studentInfo.xml"</span>), <span class="string">"student"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Properties文件解析工具"><a href="#Properties文件解析工具" class="headerlink" title="Properties文件解析工具"></a>Properties文件解析工具</h2><p>​        Properties文件就十分简单了，它的格式主要是以key-value键值对的形式存储，所以它的工具类就十分好建立了。既然是个键值对，就放在Map数据结构中，要遵循Map的规则（键值最好不要重复）。</p>
<p>​        下面给个简单的properties文件例子，该例子是我连接数据库的相关配置。</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/mec_javase_201910?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=GMT%2B8&amp;useSSL=false</span></span><br><span class="line"><span class="attr">user</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>其工具类因为它是键值对形式，所以放在一个大池子里，解析一个就放进去一个，想用就从池子取。</p>
<h3 id="PropertiesParse工具类"><a href="#PropertiesParse工具类" class="headerlink" title="PropertiesParse工具类"></a>PropertiesParse工具类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.UnsupportedEncodingException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProperitiesParse</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;String, String&gt; pool;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span> &#123;</span><br><span class="line">		pool = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loadProperities</span><span class="params">(String configFilePath)</span> </span>&#123;</span><br><span class="line">		InputStream is = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			is = <span class="keyword">new</span> BufferedInputStream(<span class="keyword">new</span> FileInputStream(configFilePath));</span><br><span class="line">			loadding(<span class="keyword">new</span> InputStreamReader(is, <span class="string">"utf-8"</span>));</span><br><span class="line">            <span class="comment">//这里是有关编码格式的问题，不必深究，尽量使用utf-8格式。</span></span><br><span class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (UnsupportedEncodingException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loadding</span><span class="params">(InputStreamReader is)</span> </span>&#123;</span><br><span class="line">		Properties property = <span class="keyword">new</span> Properties();</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			property.load(is);</span><br><span class="line">			Enumeration&lt;Object&gt;keys = property.keys();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">while</span>(keys.hasMoreElements()) &#123;</span><br><span class="line">				String key = (String) keys.nextElement();</span><br><span class="line">				String value = property.getProperty(key);</span><br><span class="line">				pool.put(key, value);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Set&lt;String&gt; <span class="title">keySet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> pool.keySet();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">value</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> pool.get(key);</span><br><span class="line">	&#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如何使用和演示结果也很简单</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PoropertiesTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		ProperitiesParse.loadProperities(<span class="string">"E:\\A大三\\大三上\\JavaProject\\20200306@XMLParse@PropertiesParse\\src\\connection.properties"</span>);</span><br><span class="line">        <span class="comment">//这里要跟绝对路径</span></span><br><span class="line">		System.out.println(ProperitiesParse.value(<span class="string">"driver"</span>));</span><br><span class="line">		System.out.println(ProperitiesParse.value(<span class="string">"url"</span>));</span><br><span class="line">		System.out.println(ProperitiesParse.value(<span class="string">"user"</span>));</span><br><span class="line">		System.out.println(ProperitiesParse.value(<span class="string">"password"</span>));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">演示结果</span></span><br><span class="line"><span class="comment">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="comment">jdbc:mysql://localhost:3306/mec_javase_201910?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=GMT%2B8&amp;useSSL=false</span></span><br><span class="line"><span class="comment">root</span></span><br><span class="line"><span class="comment">123456</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>



<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>​        至此，两个常用文件的简单解析工具就完成了。XML解析工具工具思想多一些，可以着重看也可以跟着敲一遍，才能收获更深。</p>
<p>//TODO 传文件至github上！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://honorzmj98.github.io/2020/03/06/XML%E6%96%87%E4%BB%B6%E4%B8%8EProperites%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/" data-id="ck7m4vpkn0000toi24tmsf49w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-EasySwing一键生成界面的工具" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/03/EasySwing%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7/" class="article-date">
  <time datetime="2020-03-03T07:23:58.000Z" itemprop="datePublished">2020-03-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/03/EasySwing%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7/">EasySwing一键生成界面的工具</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="EasySwing介绍"><a href="#EasySwing介绍" class="headerlink" title="EasySwing介绍"></a>EasySwing介绍</h2><p>&emsp;&emsp;不知道大家在编写Java界面部分的时候有没有这种感觉，就是设计界面这部分步骤大部分都大同小异，都是首先先new出一个新控件，然后设置这个新控件的一些属性，最后将这个控件加进相应的面板(例如:Jpanel)或者容器(例如:Container)里。反正我在设置界面的时候对于这些纷繁复杂的控件类的设置方法记不清，总要去网上查相应文档才能设置。例如<code>jfrmMain.setLocationRelativeTo(null);</code>设置窗口位于屏幕中央这句代码我总是漏写。<br>&emsp;&emsp;所以，对于这些大致逻辑相同的设置界面代码，我们可不可以方便点不写代码而进行写一些配置文件自动化（也就是一键）生成界面呢？答案是可以的，就是我准备写的EasySwing工具。  </p>
<p><strong>EasySwing</strong>：只需要写一个你想要的界面里的控件相关设置的XML文件，和有关的properties文件，就可以快速生成你想要的界面。编写这个Easyswing所需知识:XML文件解析、properties文件解析和最重要的反射机制。</p>
<h2 id="EasySwing的实现"><a href="#EasySwing的实现" class="headerlink" title="EasySwing的实现"></a>EasySwing的实现</h2><p>首先，我们可以先用以下代码简单的方式写个十分简单的界面。  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	JFrame jfrmMain = <span class="keyword">new</span> JFrame(<span class="string">"这是EasySwing的一次尝试"</span>);</span><br><span class="line">	jfrmMain.setSize(<span class="number">680</span>, <span class="number">560</span>);</span><br><span class="line">	jfrmMain.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line">	jfrmMain.setLocationRelativeTo(<span class="keyword">null</span>);</span><br><span class="line">	Container container = <span class="keyword">new</span> Container();</span><br><span class="line">	container.setLayout(<span class="keyword">new</span> BorderLayout());</span><br><span class="line">	jfrmMain.setContentPane(container);</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	Font topicFont = <span class="keyword">new</span> Font(<span class="string">"微软雅黑"</span>, Font.BOLD, <span class="number">32</span>);</span><br><span class="line">	Color topicColor = <span class="keyword">new</span> Color(<span class="number">3</span>, <span class="number">31</span>, <span class="number">203</span>);</span><br><span class="line">	JLabel jlblTopic = <span class="keyword">new</span> JLabel(<span class="string">"EasySwing的尝试"</span>, JLabel.CENTER);</span><br><span class="line">	jlblTopic.setFont(topicFont);</span><br><span class="line">	jlblTopic.setForeground(topicColor);</span><br><span class="line">	container.add(jlblTopic, BorderLayout.NORTH);</span><br><span class="line">	</span><br><span class="line">	Font normalFont = <span class="keyword">new</span> Font(<span class="string">"微软雅黑"</span>, Font.PLAIN, <span class="number">16</span>);</span><br><span class="line">	JPanel jpnlFoot = <span class="keyword">new</span> JPanel();</span><br><span class="line">	container.add(jpnlFoot, BorderLayout.SOUTH);</span><br><span class="line">	JButton jbtnAdd = <span class="keyword">new</span> JButton(<span class="string">"添加"</span>);</span><br><span class="line">	jbtnAdd.setFont(normalFont);</span><br><span class="line">	jpnlFoot.add(jbtnAdd);</span><br><span class="line">	</span><br><span class="line">	JButton jbtnDelete = <span class="keyword">new</span> JButton(<span class="string">"删除"</span>);</span><br><span class="line">	jbtnDelete.setFont(normalFont);</span><br><span class="line">	jpnlFoot.add(jbtnDelete);</span><br><span class="line">	</span><br><span class="line">	JButton jbtnModify = <span class="keyword">new</span> JButton(<span class="string">"修改"</span>);</span><br><span class="line">	jbtnModify.setFont(normalFont);</span><br><span class="line">	jpnlFoot.add(jbtnModify);</span><br><span class="line">	</span><br><span class="line">	JButton jbtnExit = <span class="keyword">new</span> JButton(<span class="string">"退出"</span>);</span><br><span class="line">	jbtnExit.setFont(normalFont);</span><br><span class="line">	jpnlFoot.add(jbtnExit);</span><br><span class="line">	</span><br><span class="line">	jfrmMain.setVisible(<span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其运行结果如下，真的只是个简单的界面，甚至说简陋，大佬勿喷。最终我们就是要用工具和配置文件实现一键产生这个界面。 </p>
<img src="/img/EasySwing/1.png" alt="1" style="zoom:50%;" />  

<h3 id="XML文件的写法以及规则的制订"><a href="#XML文件的写法以及规则的制订" class="headerlink" title="XML文件的写法以及规则的制订"></a>XML文件的写法以及规则的制订</h3><p>xml文件其实是最难想的，因为它关乎这以后如何解析的基调；同时xml文件是最好写的，因为一旦规则定下来，方便给他人出个使用说明书，只需要按着规则去写即可。我写的EasySwing工具定的以下规则:</p>
<ul>
<li>首先根标签是view</li>
<li>下一级标签是controller(控件)<ol>
<li>&ensp; id:代表控件的名称，这个非常重要因为以后所有控件都是存在一个Map（控件池）中的，这个充当键值，所以请保证不要重复</li>
<li>&ensp; para:代表该控件new出来的时候所需要的参数，其中空串代表无参构造，null代表以<code>null</code>进行构造，若是多参构造则’’里是<code>字符串类型</code>，直接写数字带小数点是<code>double</code>类型，不带小数点是<code>int</code>类型，写true或者false就是<code>boolean</code>类型，加=代表去properties文件去找相应的写好的常量（也可以直接写对应的值，这里只是为了语义性更强些和方便阅读），加#代表去所谓的控件池去找。</li>
<li>&ensp; father:代表该控件要被加在哪个容器中，若无则可以不写，若有则写该父容器的id值。</li>
<li>&ensp; locate:代表该控件加在父容器中的位置，无父容器肯定不写，若直接加则写个空串</li>
<li>&ensp; mainView:代表该控件是否是最后用来显示的主体JFrame，是要写为true，不是可以不写。</li>
</ol>
</li>
<li>下一级标签是method。如果有的控件没有要执行的方法可以不写。<ol>
<li>&ensp; name:代表该方法的名字，直接去properties文件查找</li>
<li>&ensp; para:代表该方法需要的参数，与controller的para参数一样，在此不再累赘。</li>
</ol>
</li>
</ul>
<p><strong>总结下：</strong>就是=就在properties文件里找，#就在控件池里面找，其余按相应规则去写就行。其实我们可以从XML文件发现para这个属性逻辑有些多变且复杂，确实是，我们工具就是以它开始分析和建立的。<br>以下是根据以上代码和规则写出XML文件  </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>=<span class="string">"boderLayout"</span> <span class="attr">para</span>=<span class="string">""</span> &gt;</span><span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"topicFont"</span> <span class="attr">para</span>= <span class="string">"'微软雅黑',=加粗字体, 32"</span> &gt;</span><span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"topicColor"</span> <span class="attr">para</span>= <span class="string">"3, 31, 203"</span> &gt;</span><span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"normalFont"</span> <span class="attr">para</span>= <span class="string">"'微软雅黑', =正常字体, 16"</span>&gt;</span><span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"container"</span> <span class="attr">para</span>=<span class="string">""</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置布局模式"</span> <span class="attr">para</span>= <span class="string">"#boderLayout"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"jfrmMain"</span> <span class="attr">para</span>= <span class="string">"'这是EasySwing的一次尝试'"</span> <span class="attr">mainView</span>= <span class="string">"true"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置尺寸"</span> <span class="attr">para</span>=<span class="string">"680, 560"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置默认关闭操作"</span> <span class="attr">para</span>=<span class="string">"=退出时关闭"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置相对位置"</span> <span class="attr">para</span>= <span class="string">"null"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置底层面板"</span> <span class="attr">para</span>= <span class="string">"#container"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"jlblTopic"</span> <span class="attr">para</span>= <span class="string">"'EasySwing的尝试',=标签居中"</span> <span class="attr">father</span>= <span class="string">"container"</span> <span class="attr">locate</span>= <span class="string">"边界布局.北"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置字体"</span> <span class="attr">para</span>= <span class="string">"#topicFont"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置背景颜色"</span> <span class="attr">para</span>= <span class="string">"#topicColor"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"jpnlFoot"</span> <span class="attr">para</span>= <span class="string">""</span> <span class="attr">father</span>= <span class="string">"container"</span> <span class="attr">locate</span>= <span class="string">"边界布局.南"</span>&gt;</span>			<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span>= <span class="string">"jbtnAdd"</span> <span class="attr">para</span>= <span class="string">"'添加'"</span> <span class="attr">father</span>= <span class="string">"jpnlFoot"</span> <span class="attr">locate</span>= <span class="string">""</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置字体"</span> <span class="attr">para</span>= <span class="string">"#normalFont"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span> = <span class="string">"jbtnDelete"</span> <span class="attr">para</span>= <span class="string">"'删除'"</span> <span class="attr">father</span>= <span class="string">"jpnlFoot"</span> <span class="attr">locate</span>= <span class="string">""</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置字体"</span> <span class="attr">para</span>= <span class="string">"#normalFont"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span> = <span class="string">"jbtnModify"</span> <span class="attr">para</span>= <span class="string">"'修改'"</span> <span class="attr">father</span>= <span class="string">"jpnlFoot"</span> <span class="attr">locate</span>= <span class="string">""</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置字体"</span> <span class="attr">para</span>= <span class="string">"#normalFont"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">controller</span> <span class="attr">id</span> = <span class="string">"jbtnExit"</span> <span class="attr">para</span>= <span class="string">"'退出'"</span> <span class="attr">father</span>= <span class="string">"jpnlFoot"</span> <span class="attr">locate</span>= <span class="string">""</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">method</span> <span class="attr">name</span>= <span class="string">"设置字体"</span> <span class="attr">para</span>= <span class="string">"#normalFont"</span>&gt;</span><span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">controller</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="properties文件的写法"><a href="#properties文件的写法" class="headerlink" title="properties文件的写法"></a>properties文件的写法</h3><p>properties文件就好写多了，它就是一些有关的键值对集合。其中主要包括三种</p>
<ul>
<li>控件类型 键:控件名称 值:控件的包名称    <strong>备注</strong>:导一个类后，代码最上面就有</li>
<li>方法名称 键:方法名称 值:相应类中方法的具体写法    <strong>备注</strong>:一定要查对写对，否则方法会执行失败</li>
<li>一些常量 键:常量名称 值:常量真正的值    <strong>备注</strong>:一定要查对写对，否则可能达不到预期目的  </li>
</ul>
<p>根据代码写如下properties文件</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#控件类型</span></span><br><span class="line"><span class="comment">#jfrmMain=javax.swing.JFrame</span></span><br><span class="line"><span class="attr">jfrmMain</span>=<span class="string">com.mec.Easyswing.support.MJframe</span></span><br><span class="line"><span class="comment">#container=java.awt.Container</span></span><br><span class="line"><span class="attr">container</span>=<span class="string">com.mec.Easyswing.support.MContainer</span></span><br><span class="line"><span class="attr">jlblTopic</span>=<span class="string">javax.swing.JLabel</span></span><br><span class="line"><span class="attr">boderLayout</span>=<span class="string">java.awt.BorderLayout</span></span><br><span class="line"><span class="attr">topicFont</span>=<span class="string">java.awt.Font</span></span><br><span class="line"><span class="attr">topicColor</span>=<span class="string">java.awt.Color</span></span><br><span class="line"><span class="attr">normalFont</span>=<span class="string">java.awt.Font</span></span><br><span class="line"><span class="comment">#jpnlFoot=javax.swing.JPanel</span></span><br><span class="line"><span class="attr">jpnlFoot</span>=<span class="string">com.mec.Easyswing.support.MJpnlFoot</span></span><br><span class="line"><span class="attr">jbtnAdd</span>=<span class="string">javax.swing.JButton</span></span><br><span class="line"><span class="attr">jbtnDelete</span>=<span class="string">javax.swing.JButton</span></span><br><span class="line"><span class="attr">jbtnModify</span>=<span class="string">javax.swing.JButton</span></span><br><span class="line"><span class="attr">jbtnExit</span>=<span class="string">javax.swing.JButton</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#方法名称</span></span><br><span class="line"><span class="meta">设置尺寸</span>=<span class="string">setSize</span></span><br><span class="line"><span class="meta">设置默认关闭操作</span>=<span class="string">setDefaultCloseOperation</span></span><br><span class="line"><span class="meta">设置相对位置</span>=<span class="string">setLocationRelativeTo</span></span><br><span class="line"><span class="meta">设置底层面板</span>=<span class="string">setContentPane</span></span><br><span class="line"><span class="meta">设置布局模式</span>=<span class="string">setLayout</span></span><br><span class="line"><span class="meta">设置字体</span>=<span class="string">setFont</span></span><br><span class="line"><span class="meta">设置背景颜色</span>=<span class="string">setForeground</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#一些常量</span></span><br><span class="line"><span class="meta">退出时关闭</span>=<span class="string">3</span></span><br><span class="line"><span class="meta">正常字体</span>=<span class="string">0</span></span><br><span class="line"><span class="meta">加粗字体</span>=<span class="string">1</span></span><br><span class="line"><span class="meta">斜体字体</span>=<span class="string">2</span></span><br><span class="line"><span class="meta">标签居中</span>=<span class="string">0</span></span><br><span class="line"><span class="meta">边界布局.北</span>=<span class="string">North</span></span><br><span class="line"><span class="meta">边界布局.南</span>=<span class="string">South</span></span><br><span class="line"><span class="meta">边界布局.西</span>=<span class="string">West</span></span><br><span class="line"><span class="meta">边界布局.东</span>=<span class="string">East</span></span><br><span class="line"><span class="meta">边界布局.中间</span>=<span class="string">Center</span></span><br></pre></td></tr></table></figure>
<p>应该这样来说，代码出现一个新的控件，就去给XML文件和properties文件加东西，两个是同步的，相辅相成的一起走。  </p>
<p>接下来就是重头戏了，开始写我们的工具代码部分。</p>
<h3 id="EasySwing工具的编写"><a href="#EasySwing工具的编写" class="headerlink" title="EasySwing工具的编写"></a>EasySwing工具的编写</h3><p>&emsp; 首先一上来别急着直接去解析XML文件，也不要急于编写什么逻辑复杂的东西。我们观察XML文件可以发现每个标签都存在para这个属性，这个属性就好像是所有控件的数据一样，是啊，构造需要参数，方法的执行也需要参数，发现这个参数需要多次编写多次使用，因此根据<em>Java的面对对象思想</em>我们将para独立封装成一个类ViewParameterModel。</p>
<h4 id="ViewParameterModel类"><a href="#ViewParameterModel类" class="headerlink" title="ViewParameterModel类"></a>ViewParameterModel类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewParameterModel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//任何参数都有两个属性:类型，值</span></span><br><span class="line">	<span class="keyword">private</span> Class&lt;?&gt; type;	 </span><br><span class="line">	<span class="keyword">private</span> Object value;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ViewParameterModel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setPara</span><span class="params">(String para)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (para.startsWith(<span class="string">"#"</span>)) &#123;</span><br><span class="line">			ViewFactory viewFactory = ViewFactory.currentInstance();		<span class="comment">//这个类先别管，以后会用到</span></span><br><span class="line">			Object controller = viewFactory.getController(para.substring(<span class="number">1</span>));</span><br><span class="line">			<span class="keyword">if</span> (controller == <span class="keyword">null</span>) &#123;</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">this</span>.value = controller;</span><br><span class="line">			<span class="keyword">this</span>.type = controller.getClass();</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (para.startsWith(<span class="string">"="</span>)) &#123;</span><br><span class="line">			para = ProperitiesParse.value(para.substring(<span class="number">1</span>));	<span class="comment">//这个PropertiesParse工具先忽略，我以后会给这个工具的链接</span></span><br><span class="line">		&#125;</span><br><span class="line">		setType(para);</span><br><span class="line">		setValue(para);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setType</span><span class="params">(String para)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (para.equalsIgnoreCase(<span class="string">"null"</span>)) &#123;</span><br><span class="line">			<span class="keyword">this</span>.type = Object<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (para.startsWith(<span class="string">"'"</span>) &amp;&amp; para.endsWith(<span class="string">"'"</span>)) &#123;</span><br><span class="line">			<span class="keyword">this</span>.type = String<span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (para.equalsIgnoreCase(<span class="string">"true"</span>) || para.equalsIgnoreCase(<span class="string">"false"</span>)) &#123;</span><br><span class="line">			<span class="keyword">this</span>.type = <span class="keyword">boolean</span><span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Integer.valueOf(para);</span><br><span class="line">			<span class="keyword">this</span>.type = <span class="keyword">int</span><span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Double.valueOf(para);</span><br><span class="line">			<span class="keyword">this</span>.type = <span class="keyword">double</span><span class="class">.<span class="keyword">class</span></span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;			</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setValue</span><span class="params">(String para)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (type == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> Exception(<span class="string">"XML文件para参数配置错误"</span>);	<span class="comment">//也可以自己写一个异常类</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (type.equals(Object<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = <span class="keyword">null</span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (type.equals(String<span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = para.substring(<span class="number">1</span>, para.length() - <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (type.equals(<span class="keyword">boolean</span><span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = Boolean.valueOf(para);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (type.equals(<span class="keyword">int</span><span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = Integer.valueOf(para);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (type.equals(<span class="keyword">double</span><span class="class">.<span class="keyword">class</span>)) </span>&#123;</span><br><span class="line">			<span class="keyword">this</span>.value = Double.valueOf(para);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function">Object <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Class&lt;?&gt; getType() &#123;</span><br><span class="line">		<span class="keyword">return</span> type;</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到编写这个类的目的十分简单，任何参数都有两个共同的属性，一个是参数类型（这里只涉及简单的类型：<code>int</code>，<code>double</code>，<code>boolean</code>，<code>String</code>）,另一个是参数的值。这个类就是根据上面的XML编写规则的简单逻辑写出来的，不存在什么难度。关于代码中的ViewFactory（后面的工具类）和PropertiesPrase（以后我会给链接）。  </p>
<p><strong>tips:要记得局部性验证这个类对不对，可不可用，因为它是这个工具最基础的类，就像建高楼大厦一定要保证地基一样耐用。同时这个最基础的类不是一蹴而就写出来的，一定是经过再往前走一些步骤后才逐步完善出来的</strong></p>
<p><a href="https://honorzmj98.github.io/2020/03/06/XML文件与Properites文件解析工具/">Properties文件解析工具</a></p>
<hr>
<p>&emsp; 接下来，我们知道一个方法未必只有一个参数（ViewParameterModel只代表一个参数），且参数是有顺序关系的，所以考虑用List存储相关参数是一个解决方法。所以要把刚才的ViewParameterModel类当成个工具使用，再生成个类ViewParameters。</p>
<h4 id="ViewParameters类"><a href="#ViewParameters类" class="headerlink" title="ViewParameters类"></a>ViewParameters类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewParameters</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> List&lt;ViewParameterModel&gt; parameters;</span><br><span class="line">	</span><br><span class="line">	ViewParameters(String para) <span class="keyword">throws</span> Exception &#123; 					<span class="comment">//传过来的参数直接就是XML文件para内容</span></span><br><span class="line">		String[] paras = para.split(<span class="string">","</span>);</span><br><span class="line">		<span class="keyword">if</span> (paras.length == <span class="number">1</span> &amp;&amp; paras[<span class="number">0</span>].trim().length() &lt;= <span class="number">0</span>) &#123;		<span class="comment">//这里代表para内容是""，空串</span></span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		parameters = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; paras.length; i++) &#123;</span><br><span class="line">			ViewParameterModel viewParameterModel = <span class="keyword">new</span> ViewParameterModel();</span><br><span class="line">			viewParameterModel.setPara(paras[i].trim());</span><br><span class="line">			parameters.add(viewParameterModel);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Class&lt;?&gt;[] getParametersType() &#123;	<span class="comment">//得到参数的类型数组，方便反射机制用来找方法</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (parameters == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> Class&lt;?&gt;[] &#123;&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> count = parameters.size();</span><br><span class="line">		Class&lt;?&gt;[] result = <span class="keyword">new</span> Class&lt;?&gt;[count];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">			result[i] = parameters.get(i).getType();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	Object[] getParametersValue() &#123;	<span class="comment">//得到参数的值数组，方便反射机制执行方法</span></span><br><span class="line">		<span class="keyword">if</span> (parameters == <span class="keyword">null</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">new</span> Object[] &#123;&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> count = parameters.size();</span><br><span class="line">		Object[] result = <span class="keyword">new</span> Object[count];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">			result[i] = parameters.get(i).getValue();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> result;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个类的核心数据就是parameters，它是由ViewParameterModel类组成的List。构造方法是用来建立parameters的，然后其他两个方法得到参数类型数组和得到参数值数组都是以后反射机制需要用的。这个类完美的体现了<strong><em>Java的面向对象思想</em></strong>。  </p>
<blockquote>
<p>Java面向对象思想:一个类的核心是成员，类的建立就是通过考虑成员才建立出来的，该类的所有方法都是围绕这个成员来进行操作的。考虑问题不是考虑完成这个问题的具体步骤（面向过程思想），而是先考虑能把问题分成由哪些对象或者成员组成，由多个对象的联系来完成问题。  </p>
</blockquote>
<p><strong>tips:要记得进行局部性验证，保证做到现在为止是否正确。</strong></p>
<hr>
<p>&emsp;接下来就要考虑XML文件中各个控件的存放了，还没有进行真正的XML解析，还是只考虑XML文件中的一些数据。此时，XML文件中controller标签中id属性才能体现出作用，起id这个名字才能说的通，它是主键。存放XML中各个控件用Map存放，键为该控件名称，值为该控件真正的对象。<code>Map&lt;String, Object&gt;</code>关于这里值为Object类型，因为控件类型各有不同所以用Object来统一管理（Object是一切类的基类）。<br>&emsp;但是！！！<strong>问题也出在Object！</strong>如果值为Object，说明他什么都可以接收，什么都可以向这个Map里面放，也就意味着可以放入根本不属于控件类型的对象。这麻烦就大了。所以“<strong>万物皆可Object</strong>“这句话既是褒义词也是贬义词。因为它是所有类基类，所以我们可以很方便用它，但是，也正是因为它是所有类的基类，也会带来危险。<br>&emsp;说上面这些话是为了引出工具保护思想，就拿这里做例子，我们一定不能把这个存放控件的<code>Map</code>传到外面让他人使用，防止他人放不应该放的东西进行破坏。细心的人可能发现我前面的工具类基本很少有public，都是用的包权限。这就是工具的保护！只能在这个包下进行操作，包外无权处理。<strong>所以做工具一定要有工具保护思想！！！</strong>。<br>&emsp;上面说了这么多，只是提出一个小的工具编程思想。接下来真正的引出我们下一个工具类ViewFactory。</p>
<h4 id="ViewFactory类"><a href="#ViewFactory类" class="headerlink" title="ViewFactory类"></a>ViewFactory类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewFactory</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Map&lt;String, Object&gt; viewControllerPool;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ViewFactory viewFactory;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">ViewFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		viewControllerPool = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ViewFactory <span class="title">newInstance</span><span class="params">()</span> </span>&#123;	<span class="comment">//代表新界面的ViewFactory</span></span><br><span class="line">		viewFactory = <span class="keyword">new</span> ViewFactory();</span><br><span class="line">		<span class="keyword">return</span> viewFactory;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ViewFactory <span class="title">currentInstance</span><span class="params">()</span> </span>&#123;	<span class="comment">//代表当前界面的ViewFactory</span></span><br><span class="line">		<span class="keyword">return</span> viewFactory == <span class="keyword">null</span> ? newInstance() : viewFactory;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addController</span><span class="params">(String id, Object object)</span> </span>&#123;</span><br><span class="line">		viewControllerPool.put(id, object);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">getController</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> viewControllerPool.get(id);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;这个类的核心是viewControllerPool，用来存放XML中相应控件的，关于增加控件和得到控件两个方法很简单，就不再赘述。<br>&emsp;但是关于另一个成员viewFactory我要说下。这是一种十分简单的单例模式，就意思这个类只需要也只能有一个对象。考虑下面一种问题，如果已经产生了个界面，然后又要产生界面怎么办？两个界面肯定控件不同呀，不能往pool里一直加东西吧，如果键重复了可不就出问题了吗？所以给了两个得到ViewFactory的方法，一个是<code>newnewInstance()</code>该方法表明新开个界面，其中的pool就重新申请了，不管以前的控件了。另一个是<code>currentInstance()</code>意思是当前的ViewFactory对象，如果没有则申请，如果有则可得到当前的pool里面放着当前界面的已经加进去的控件。  </p>
<hr>
<p>接下来，是EasySwing工具最后一个类了。终于在前面我们分析并解决了XML文件中一些数据的存储问题，接下来就是真正的解析XML文件了，然后用已经建好的工具类去存储相关数据了。</p>
<p><a href="https://honorzmj98.github.io/2020/03/06/XML文件与Properites文件解析工具/">XML文件解析工具</a></p>
<h4 id="ViewFactoryBuilder类"><a href="#ViewFactoryBuilder类" class="headerlink" title="ViewFactoryBuilder类"></a>ViewFactoryBuilder类</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewFactoryBuilder</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String jframe = <span class="string">"mainView"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">ViewFactoryBuilder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">showView</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		ViewFactory viewFactory = ViewFactory.currentInstance();</span><br><span class="line">		JFrame mainView = (JFrame) viewFactory.getController(jframe);</span><br><span class="line">		mainView.setVisible(<span class="keyword">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loadPropertiesFileConfigPath</span><span class="params">(String configPath)</span> </span>&#123;</span><br><span class="line">		ProperitiesParse.loadProperities(configPath);</span><br><span class="line">		<span class="comment">//加载相关的properties文件，要用绝对路径</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loadXMLFileConfigPath</span><span class="params">(String configPath)</span> </span>&#123;	<span class="comment">//参数是相关XML文件路径，可以是相对路径</span></span><br><span class="line">		ViewFactory viewFactory = ViewFactory.newInstance();	<span class="comment">//解析一个新的XML文件代表新的一个ViewFactory里要存放新的控件</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">new</span> XMLParse() &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealElement</span><span class="params">(Element element, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">				String id = element.getAttribute(<span class="string">"id"</span>);</span><br><span class="line">				String para = element.getAttribute(<span class="string">"para"</span>);</span><br><span class="line">				String father = element.getAttribute(<span class="string">"father"</span>);</span><br><span class="line">				String locate = element.getAttribute(<span class="string">"locate"</span>);</span><br><span class="line">				String mainView = element.getAttribute(<span class="string">"mainView"</span>);</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Class&lt;?&gt; klass = Class.forName(ProperitiesParse.value(id));</span><br><span class="line">					ViewParameters viewParameters = <span class="keyword">new</span> ViewParameters(para);</span><br><span class="line">					Constructor&lt;?&gt; constructor = klass.getDeclaredConstructor(viewParameters.getParametersType());</span><br><span class="line">					Object controller = constructor.newInstance(viewParameters.getParametersValue());</span><br><span class="line">					<span class="keyword">if</span> (mainView.equalsIgnoreCase(<span class="string">"true"</span>)) &#123;</span><br><span class="line">						viewFactory.addController(jframe, controller);</span><br><span class="line">					&#125;</span><br><span class="line">					viewFactory.addController(id, controller);</span><br><span class="line">					parseMethod(element, klass, controller);</span><br><span class="line">					addController(father.trim(), locate.trim(), controller, viewFactory);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;.parseTag(XMLParse.getDocument(configPath), <span class="string">"controller"</span>);</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">parseMethod</span><span class="params">(Element element, Class&lt;?&gt; klass, Object controller)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">new</span> XMLParse() &#123;</span><br><span class="line">			</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dealElement</span><span class="params">(Element element, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">				String name = element.getAttribute(<span class="string">"name"</span>);</span><br><span class="line">				String para = element.getAttribute(<span class="string">"para"</span>);</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					ViewParameters viewParameters = <span class="keyword">new</span> ViewParameters(para);</span><br><span class="line">					Method method = klass.getMethod(ProperitiesParse.value(name), viewParameters.getParametersType());</span><br><span class="line">					method.invoke(controller, viewParameters.getParametersValue());</span><br><span class="line">				&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;.parseTag(element, <span class="string">"method"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">addController</span><span class="params">(String father, String locate, Object sonController, ViewFactory viewFactory)</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (father.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		IPaneAddMethod fatherController = (IPaneAddMethod) viewFactory.getController(father);</span><br><span class="line">		<span class="keyword">if</span> (locate.length() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">			fatherController.IAdd((Component) sonController);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			String location = ProperitiesParse.value(locate);</span><br><span class="line">			fatherController.IAdd((Component) sonController, location);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个类是最容易出错的地方，记录下我所踩过的坑。</p>
<ol>
<li>反射得到方法，我用的是getDeclaredMethod()，这个可以获获得到本类的所有方法，包括public，private，protected修饰的，但是他不可以得到父类的方法。经过修改应该用getMethod()，能获取当前类和父类public修饰的方法，仅限public。因为有些控件的方法是父类的，所以要用getMethod()。</li>
<li>进行局部性验证的时候发现，总是出现NoSuchMethodException()异常，仔细查看，发现问题。<code>java.awt.Container.setLayout(java.awt.BorderLayout)</code>和<code>javax.swing.JFrame.setLocationRelativeTo(java.lang.Object)</code>经过查看源码发现是参数类型不对，所以找不到该方法。</li>
</ol>
<p>为了解决第二个问题，采用以下方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MJframe</span> <span class="keyword">extends</span> <span class="title">JFrame</span> </span>&#123;	<span class="comment">//继承JFrame，以便完成某些特定方法</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">324446629969726058L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MJframe</span><span class="params">()</span> <span class="keyword">throws</span> HeadlessException </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MJframe</span><span class="params">(GraphicsConfiguration gc)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(gc);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MJframe</span><span class="params">(String title)</span> <span class="keyword">throws</span> HeadlessException </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(title);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MJframe</span><span class="params">(String title, GraphicsConfiguration gc)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>(title, gc);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLocationRelativeTo</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setLocationRelativeTo(<span class="keyword">null</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentPane</span><span class="params">(MContainer contentPane)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setContentPane(contentPane);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPaneAddMethod</span> </span>&#123;<span class="comment">//该接口是为了方便以后容器里面加控件的方便。</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">IAdd</span><span class="params">(Component component)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">IAdd</span><span class="params">(Component component, Object object)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MContainer</span> <span class="keyword">extends</span> <span class="title">Container</span> <span class="keyword">implements</span> <span class="title">IPaneAddMethod</span> </span>&#123; </span><br><span class="line">	<span class="comment">//继承Container类，以便完成某些方法，同时实现IPaneAddMethod接口，以便以后加控件</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">7116483843211133420L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">MContainer</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLayout</span><span class="params">(BorderLayout borderLayout)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setLayout(borderLayout);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLayout</span><span class="params">(FlowLayout flowLayout)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setLayout(flowLayout);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLayout</span><span class="params">(GridLayout gridLayout)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.setLayout(gridLayout);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">IAdd</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.add(component);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">IAdd</span><span class="params">(Component component, Object object)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.add(component, object);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MJpnlFoot</span> <span class="keyword">extends</span> <span class="title">JPanel</span> <span class="keyword">implements</span> <span class="title">IPaneAddMethod</span> </span>&#123;<span class="comment">//继承JPnel，方便以后加控件</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">7489743937546425832L</span>;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">IAdd</span><span class="params">(Component component)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">super</span>.add(component);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">IAdd</span><span class="params">(Component component, Object object)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">super</span>.add(component, object);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同时去修改properties文件里的配置即可解决。<br>该类（ViewFactoryBuilder）的主要任务是扫面XML文件，并根据XML文件结合以前的工具类，并将加载配置方法和显示最后的主界面对外用。<br>至此，EasySwing工具的主要四个工具类就全部做完了！  </p>
<hr>
<h3 id="EasySwing工具具体的使用步骤"><a href="#EasySwing工具具体的使用步骤" class="headerlink" title="EasySwing工具具体的使用步骤"></a>EasySwing工具具体的使用步骤</h3><ol>
<li>首先将想要生成的界面有关配置文件（XML文件和properties文件）根据上面所述规则写好。</li>
<li>ViewFactoryBuilder.loadPropertiesFileConfigPath(“properties文件的绝对路径”)</li>
<li>ViewFactoryBuilder.loadXMLFileConfigPath(“XML文件的相对路径”);</li>
<li>ViewFactoryBuilder.showView();就可以生成想要的界面了。  </li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		ViewFactoryBuilder.loadPropertiesFileConfigPath(<span class="string">"E:\\A大三\\大三上\\JavaProject\\20200303@Easyswing\\src\\initViewStore.properties"</span>);</span><br><span class="line">		ViewFactoryBuilder.loadXMLFileConfigPath(<span class="string">"/initViewCfg.xml"</span>);</span><br><span class="line">		ViewFactoryBuilder.showView();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>运行上述代码后，结果如下:<br><img src="/img/EasySwing/2.png" alt="1" style="zoom:50%;" /></p>
<p>我保证绝对不是只把上面图copy过来，就是用EasySwing工具运行出来的。不信你们可以用这个工具去试一试。我会将它上传到Github上。<br><strong>//TODO上传工具代码到github上</strong></p>
<hr>
<p>至此，EasySwing工具的编写告一段落了。<br><strong>但是！！！</strong> 其实这个工具还没有达到完美。有两个问题。  </p>
<ol>
<li>不知道你有没有发现我写的XML文件的顺序是不能变的，也就是说，一些必须要先生成的控件必须写在XML文件前面，后生成的控件才可以用它。这样给用户带来不便了，理想情况应该是写XML文件的顺序对于生成界面要没有影响。所以，我这还是有点瑕疵的，等待进一步完善。</li>
<li>控件的响应事件没有添加，按按钮应该要产生相应的事件啊。是，这是锦上添花的事，以后等我进一步完善。</li>
</ol>
<p><strong>在此感谢王兆阳同学和朱洪老师的耐心指导！</strong></p>
<p align="right">最后编辑于:2020-03-04 </p>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://honorzmj98.github.io/2020/03/03/EasySwing%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7/" data-id="ck7m4vpl80001toi215gu82gh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-我的第一篇博客" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/02/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" class="article-date">
  <time datetime="2020-03-02T06:58:20.220Z" itemprop="datePublished">2020-03-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/02/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/">我的第一篇博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>&emsp;&emsp;这是我的第一篇博客，首先要感谢一个B站up主，根据他的视频<a href="https://www.bilibili.com/video/av44544186" target="_blank" rel="noopener">搭建个人博客</a>，我才建立起自己的Hexo博客的。因为是第一次写博客，所以对一些内容还不是很熟悉，并且排版也不是很美观，以后会尽量多学习和多写博客，争取写出排版美观，内容充实的好博文。</p>
<p>&emsp;&emsp;先来简要说说我的大一大二生活吧，我大一大二就是玩上来的基本没有学习，倒是游戏的Rank分打的挺高，还自诩自己是西邮GuXue和西邮第一辅助，为了游戏上分，我经常熬夜打游戏，就这样浑浑噩噩过了两年，荒废了两年时光。直到大二下才彻底醒悟，觉得我游戏打那么好也不算什么特长以后也不能写在简历上拿这个去找工作。还想到曾经老师讲过的一句话:“一个人虚拟世界等级越高，他在现实生活中就越空虚。”我发现说的真对，我在现实生活中就和网上是截然不同性格的两个人，网络中我打字飞快，和网友什么骚话和梗都能说得出，现实生活中唯唯诺诺，参加聚会就一个人独自在旁边听，一句话也不说。  </p>
<p>&emsp;&emsp;因此，我从大二下就开始改变了。我开始听课了，并且有一些喜欢的课程。我有好习惯的，喜欢总结东西，有整理笔记的好习惯。但纸质笔记有个缺点，不易携带，且我个人不喜欢写标题而且字有点潦草，每次翻阅查找都很麻烦。直到知道了博客，完全可以解决上述缺点，因此我准备把写笔记的好习惯改为写博文的好习惯，用来记录我在学习中的问题。下面来写下我自己认为写博文的好处。</p>
<h2 id="写博客的好处"><a href="#写博客的好处" class="headerlink" title="写博客的好处"></a>写博客的好处</h2><ol>
<li>&emsp;写博客可以系统的整合自己某一阶段的学习成果。以前我的写在本子上的笔记就是这样的，先听老师上课讲，我就旁边放上草稿纸，记住关键性的内容，课后利用时间去整理，再去查资料完善笔记。现在就是把记笔记的过程换成写博客的过程，两者都是对自己某一阶段的学习做个总结。在这里我对自己提出要求：一定不能拖，讲完的内容趁热打铁，尽快写成自己通俗易懂的文字进行总结。  </li>
<li>&emsp;提高总结能力。这点是我缺乏的，我需要锻炼的，因为我在做老师给的小项目的时候，总喜欢把问题划分到很细，总是考虑细枝末节，就偏离了主心骨了。就像一棵树，考虑问题一定要先完成树干主心骨这里的问题，不能盲目直接考虑到树枝枝芽，那样说不定会被陷在里面不能自拔。所以我要写博文提高自己总结能力，以到达问问题和总结问题一针见血的目的。</li>
<li>&emsp;提高表达能力。我这个人不爱说话,但是和熟人却能畅谈，这可能就是人们说的性格:闷骚。网络看不见陌生人，或者都是陌生人，我就不在乎了，心理上就不会有所畏惧，就能大胆放心说话了。（反正你们又不认识我，也没见过我，更不能隔着屏幕来打我^_^）。还是要提高表达和与他人交流的能力的！因为以后面试的时候要面对面试官，当然要把自己所知道的知识大大方方的给面试官说出来。</li>
</ol>
<h2 id="对自己的要求"><a href="#对自己的要求" class="headerlink" title="对自己的要求"></a>对自己的要求</h2><ol>
<li>&emsp;对于我这种编程小白来说现在写博文就写自己学习上遇到的问题和自己做的小项目，同时我将保证自己写的每个代码可以复现，这样为别人带来方便。给现在自己定的最大的目标:可以在秋招找个好工作。而现在小目标就是编程中遇到的问题，经过总结写成博文。就这样，一步步实现每个目标。</li>
<li>&emsp;要把博客空间看做自己的网络小家，就像以前非主流时期（黑历史）打理自己空间一样精心打理博客。里面放着我在网上贡献的一切，以后希望回头看能看到充实的大学生活。</li>
<li>&emsp;一定要坚持下来！坚持就是胜利。写博客要变成一种习惯，要成为每天必做的事。吾日三省吾身，今天博文写了吗？今天在写博文吗？今天有什么要写成博文的吗？一定要坚持，开始是很难的，排版也不美观，写的也没什么技术含量，但只要坚持写，一切都会变好的！</li>
</ol>
<p><br></br><br>&emsp;&emsp;好了，话不多说，现在就开始去写一篇技术博客。<br><br></br><br><br></br></p>
<p align="right">最后编辑于:2020-03-03 14:54:57 星期二</p>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://honorzmj98.github.io/2020/03/02/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/" data-id="ck7m4vplj0002toi2cxl50w22" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/03/11/CSFramework%E5%B0%8F%E5%9E%8B%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">CSFramework小型开发工具</a>
          </li>
        
          <li>
            <a href="/2020/03/11/CSFramework%E7%9A%84%E5%BC%95%E5%87%BA/">CSFramework的引出</a>
          </li>
        
          <li>
            <a href="/2020/03/06/XML%E6%96%87%E4%BB%B6%E4%B8%8EProperites%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/">XML文件与Properites文件解析工具</a>
          </li>
        
          <li>
            <a href="/2020/03/03/EasySwing%E4%B8%80%E9%94%AE%E7%94%9F%E6%88%90%E7%95%8C%E9%9D%A2%E7%9A%84%E5%B7%A5%E5%85%B7/">EasySwing一键生成界面的工具</a>
          </li>
        
          <li>
            <a href="/2020/03/02/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/">我的第一篇博客</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 HonorZmj98<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>